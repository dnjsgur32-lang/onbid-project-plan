# [1주 완성] 온비드 공매정보 알림·조회 서비스: 프로젝트 개발 기획서

기간: 7일 (YYYY-MM-DD ~ YYYY-MM-DD, 서울/Asia-Seoul)
대상 API: **한국자산관리공사_온비드 캠코공매물건/이용기관 공매물건/물건 정보 조회서비스**
산출물: 웹 앱(MVC) + 배치/알림 모듈 + 데이터베이스 + 대시보드 + 운영 문서

## 0) 프로젝트 한눈에 보기

- **문제**: 온비드(Onbid) 공매 정보는 흩어져 있고, 관심 조건(지역/용도/매각·임대/마감임박 등)에 맞춘 **맞춤형 알림**과 **간단한 분석**이 부족함.
- **해결**: 공공데이터포털 Onbid 오픈API를 통해 공고·물건을 수집/정제 → **즐겨찾기 조건 기반 자동 알림**(마감 임박·신규·수의계약 가능 등) + **요약 카드** + **간단한 통계 시각화** 제공.
- **핵심 가치**: 투자/업무 의사결정 속도 향상, 반복 검색 자동화, 일정 관리 지원.
- **MVP 슬로건**: *“관심조건만 저장하면, 공매 기회가 먼저 온다.”*

---

## 1) 분석 (Problem → Goal → Metric)

**Problem**

- 신규/마감임박 공고를 놓치기 쉽고, 조건 필터/정렬/북마크/알림의 연속성이 부족.

**Goal**

- 관심조건 저장 1분 내 완료
- 하루 2회 자동 동기화 + 알림
- 공고→물건→일정까지 3클릭 이내 열람

**Metric (MVP)**

- D7 Retention ≥ 30%
- 알림 클릭률(CTR) ≥ 20%
- 평균 탐색 시간(관심 공고 도달) ≤ 20초

---

## 2) 주요 기능 (MVP/차기)

### MVP (1주)

1. **검색/필터**: 공고종류(매각/임대/통합), 지역(시·도/시·군·구), 용도(코드), 처분방식, 입찰방식, 마감임박(≤3일), 신규(24h).
2. **관심조건 저장 & 북마크**: 조합 조건 저장(여러 개), 결과 리스트 북마크.
3. **자동 알림**: cron/스케줄러로 하루 2회 동기화 → 신규/마감임박/수의계약가능 푸시(웹/앱 or 이메일 대체 알림 배너) 및 내 알림함.
4. **공고·물건 상세**: 기본 현황, 입찰방식/경쟁구조/참가조건, 일정(입찰·개찰), 첨부파일 링크.
5. **간단 통계**: 오늘 등록 수, 주간 등록 추이, 카테고리 Top5, 지역 분포(막대/파이).

### 차기 (2~4주)

- 캘린더(ICS) 내보내기, 가격/낙찰 통계(과거 파일데이터 연계), 사용자별 추천, SMS/앱 푸시 연동, 지도로 보기(좌표 보유 시), 워치리스트 공유.

---

## 3) 대상 공공 API

- **한국자산관리공사_온비드 캠코공매물건 조회서비스** (공고/상세/일정)
- **한국자산관리공사_온비드 이용기관 공매물건 조회서비스** (기관별 공고/통합/매각/임대/마감임박)
- **한국자산관리공사_온비드 물건 정보 조회서비스** (용도별 물건목록·상세, 새로운/마감임박/수의계약가능/Top20 등)
- **온비드 용도별 코드정보** (코드 테이블 사전 로딩)

> 인증: 공공데이터포털 발급 서비스키(URL 인코딩) 사용. 응답 포맷: XML/JSON (가용 형식에 맞춰 파서 구성).
> 

---

## 4) 정보 구조 & 화면 설계(IA)

### 사용자 흐름(핵심)

1. 홈(요약 대시보드) → 2. 검색(필터) → 3. 결과 리스트 → 4. 상세(공고/물건/일정/첨부) → 5. 북마크/관심조건 저장 → 6. 알림 수신

### 화면 목록

- 홈: KPI 카드(신규/임박/수의/총합), 최근 알림, 관심조건 카드
- 검색/필터: 지역/용도/공고종류/마감임박/신규/입찰방식/처분방식
- 결과 리스트: 테이블/카드 뷰 전환, 정렬(마감일, 등록일)
- 상세: 기본정보, 참가조건, 일정, 첨부, 기관 정보, 외부 링크(온비드)
- 알림함: 신규/임박/수의 알림 리스트, 읽음표시
- 설정: 관심조건 관리, 데이터 동기화 주기 설정

---

## 5) 데이터 모델 (초안 ERD)

**Tables**

- `users(id, email, nickname, created_at)`
- `search_profile(id, user_id FK, name, region_sido, region_sigungu, use_code, notice_type, sale_type, bid_type, is_emergency, is_new, created_at)`
- `notices(id, notice_no, notice_type, org_name, title, status, start_dt, end_dt, bid_dt, open_dt, method, attachment_url, region, use_code, raw_hash, created_at, updated_at)`
- `items(id, item_no, notice_no FK, category, address, appraised_price, min_bid_price, contract_type, is_private_contract, etc_json)`
- `bookmarks(id, user_id FK, notice_id FK, created_at)`
- `alerts(id, user_id FK, notice_id FK, type(enum:new,imminent,private), sent_at, read_at)`
- `code_use(id, code, name, parent_code, level)` ← 사전 로드(온비드 용도코드)

**인덱스/정합성**

- notices.notice_no UNIQUE, items.item_no UNIQUE, (user_id, notice_id) UNIQUE in bookmarks
- API 응답 해시(raw_hash)로 변경 감지 upsert

---

## 6) API 통합 설계 (요청/응답 예시)

> 실제 파라미터명은 오픈API 스펙을 따르며, 아래는 **형식 예시(샘플)**입니다.
> 

### 6.1 공고 목록 조회 (기관별/유형별)

`GET /onbid/notices?type=sale&region=서울&deadlineWithin=3&useCode=XXXX&serviceKey=...`

- 응답요지: `[ { noticeNo, type, orgName, title, startDt, endDt, bidDt, isImminent, region, useCode }, ... ]`

### 6.2 물건 목록/상세 조회

`GET /onbid/items?noticeNo=2025-XXXX&serviceKey=...`

- 응답요지: `[ { itemNo, address, appraisedPrice, minBidPrice, contractType, attachments[] }, ... ]`

### 6.3 일정/첨부

`GET /onbid/notices/{noticeNo}/schedule`

- 응답요지: `{ bidDt, openDt, docUrls[] }`

### 6.4 코드 동기화(배치)

`GET /onbid/codes/use`

- 응답요지: `[ { code, name, parentCode, level }, ... ]`

---

## 7) 아키텍처

- **프런트**: React/Vue(선택) + Tailwind or Bootstrap, i18n(ko)
- **백엔드**: Spring Boot 3.5 + MyBatis(JDBC) + Lombok
- **DB**: MariaDB 10.x (Docker 가능)
- **배치/스케줄러**: Spring Scheduler (예: 09:00, 18:00 동기화)
- **캐시**: Caffeine/Redis(선택) – 단기 캐싱(10~30분)
- **로그/모니터링**: Spring Actuator + Logback + (차기) Prometheus/Grafana
- **배포**: 단일 인스턴스 Jar + Nginx(정적/리버스프록시)

---

## 8) 보안/법적/운영 유의사항

- 서비스키 보호: 서버사이드에서만 호출, .properties 분리, 환경변수/Secret 관리
- Rate Limit: 호출 간격/쿼리 폭 제한, 재시도/백오프
- 저작권/출처 표기: 온비드/캠코/공공데이터포털 출처 고지
- 개인정보 미수집(닉네임/이메일 최소화), 로그 마스킹
- 장애 대응: API 장애 시 캐시/로컬 스냅샷 fallback

---

## 9) 테스트 계획

- 단위: 파라미터 매핑, 파서(XML/JSON) → DTO
- 통합: API 호출 Mock + 실제키(개발용) 분리
- 회귀: 배치 동작, 알림 중복 방지(해시/키)
- E2E: 관심조건 생성→알림 수신 → 상세 진입까지 시나리오 3건

---

## 10) 배포/운영

- 브랜치 전략: main/release
- 환경: dev(.env.dev) → prod(.env.prod)
- 스케줄러: 09:00/18:00 실행, 로그 요약 일일 리포트
- 백업: DB 일 1회 스냅샷, 코드주석/릴리스노트 관리

---

## 11) 1주 일정(일일 WBS)

**D1 – 기획/설계**: 요구정의, IA, 와이어프레임, ERD, API 키 발급/확인
**D2 – 백엔드 스캐폴드**: Spring Boot 프로젝트, 도메인/매퍼/서비스 뼈대, 코드테이블 로더
**D3 – API 연동**: 공고/물건 목록 파서, 응답→DB upsert, 스케줄러 1차
**D4 – 프런트 1차**: 검색폼/리스트/상세 레이아웃, 정렬/페이징
**D5 – 알림/북마크**: 관심조건/알림함, 중복제어, 배치 2차(신규/임박)
**D6 – 통계/대시보드**: KPI 카드/차트, 성능 개선(캐시)
**D7 – 테스트/배포**: E2E 시나리오, 문서화, 프로덕션 배포

---

## 12) 성공 지표 대시보드(KPI)

- 신규/임박 알림 수/일, 알림 CTR, 북마크 수, 관심조건 수, 오류율

---

## 13) 네이밍 후보

- **BidBird**, **OnWatch**, **GongmaeNow**, **BidRadar**, **K-Onbid Alert**

---

## 14) 백로그(우선순위)

1. 캘린더 내보내기(ICS), 마감 D-표기 강화
2. 지도로 보기(주소→좌표), 지역 필터 UX 개선
3. 가격/낙찰 통계(연도별 CSV 연계) & 예산 필터
4. SNS 공유, 팀 공유 워크스페이스(읽기전용 링크)

---

## 15) 예시 DDL (MariaDB)

CREATE TABLE code_use (

user_id BIGINT,

name VARCHAR(60),

region_sido VARCHAR(30),

region_sigungu VARCHAR(30),

use_code VARCHAR(20),

notice_type VARCHAR(10),

sale_type VARCHAR(20),

bid_type VARCHAR(20),

is_emergency BOOLEAN,

is_new BOOLEAN,

created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

FOREIGN KEY (user_id) REFERENCES users(id)

);

CREATE TABLE notices (

id BIGINT PRIMARY KEY AUTO_INCREMENT,

notice_no VARCHAR(40) UNIQUE,

notice_type VARCHAR(10),

org_name VARCHAR(120),

title VARCHAR(300),

status VARCHAR(20),

start_dt DATETIME,

end_dt DATETIME,

bid_dt DATETIME,

open_dt DATETIME,

method VARCHAR(60),

attachment_url TEXT,

region VARCHAR(60),

use_code VARCHAR(20),

raw_hash CHAR(64),

created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

updated_at TIMESTAMP NULL

);

CREATE TABLE items (

id BIGINT PRIMARY KEY AUTO_INCREMENT,

item_no VARCHAR(40) UNIQUE,

notice_no VARCHAR(40),

category VARCHAR(60),

address VARCHAR(200),

appraised_price DECIMAL(18,2),

min_bid_price DECIMAL(18,2),

contract_type VARCHAR(30),

is_private_contract BOOLEAN,

etc_json JSON,

FOREIGN KEY (notice_no) REFERENCES notices(notice_no)

);

CREATE TABLE bookmarks (

id BIGINT PRIMARY KEY AUTO_INCREMENT,

user_id BIGINT,

notice_id BIGINT,

created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

UNIQUE KEY uq_user_notice (user_id, notice_id),

FOREIGN KEY (user_id) REFERENCES users(id),

FOREIGN KEY (notice_id) REFERENCES notices(id)

);

CREATE TABLE alerts (

id BIGINT PRIMARY KEY AUTO_INCREMENT,

user_id BIGINT,

notice_id BIGINT,

type ENUM('new','imminent','private'),

sent_at DATETIME,

read_at DATETIME NULL,

FOREIGN KEY (user_id) REFERENCES users(id),

FOREIGN KEY (notice_id) REFERENCES notices(id)

);

---

## 16) 스케줄러/알림 로직(의사코드)

매일 09:00/18:00

for each search_profile:

call Onbid API with filters

upsert(notices/items)

if 신규 또는 마감임박 발견 → alerts 생성 → 웹 알림 배너/알림함 적재

generate KPI snapshot

---

## 17) 리스크 & 대응

- API 구조 변경/장애: 응답 밸리데이션 + 예외처리 + 캐시 fallback
- 호출량 초과: 페이징/지연 호출, 프로필별 쿼리 수 제한, 야간 풀싱크
- 주소 정규화 실패: 후순위, 지도 기능은 차기로 분리
- 일정 지연: D3~D5 버퍼 20% 확보, 차기 기능 컷

---

## 18) 문서/운영 산출물 체크리스트

- 요구정의서, ERD, API 명세(파라미터/응답 매핑표), 테스트 케이스, 운영가이드(키 관리/스케줄/백업/복구)

---

## 19) 데모 시나리오(5분)

1. 관심조건 생성(서울·매각·용도=업무시설·마감≤3일) → 2) 결과 정렬/북마크 → 3) 상세에서 일정/첨부 확인 → 4) 알림함에서 신규/임박 확인 → 5) 대시보드 지표 확인

---

## 20) 차기 확장 아이디어

- 지역/용도별 낙찰률·경쟁률 추세(연도별 CSV 연계)
- 예산/수익성 가정(감정가·최저가 기반) 간이 시뮬레이터
- 팀/고객 공유 링크, PDF 리포트 내보내기